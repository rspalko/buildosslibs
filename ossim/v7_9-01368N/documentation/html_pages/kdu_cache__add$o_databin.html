<HTML>
<HEAD>
<TITLE> Kakadu Hyper-Doc (kdu_cache::add_to_databin) </TITLE>
<STYLE TYPE="text/css">
<!--
.indented-text { padding-left: 20pt; }
.function-text { padding-left: 80pt;
                 text-indent: -60pt; }
-->
</STYLE>
</HEAD>
<BODY TEXT="#000000" LINK="#0000ff" BGCOLOR="#B4DCB4">
<P ALIGN="RIGHT">|<A HREF="#SynopsiS"> synopsis </A>||<A HREF="#ReturnS"> return value </A>||<A HREF="#ArgS"> arguments </A>||<A HREF="kdu_cache__close.html"> prev </A>||<A HREF="kdu_cache__del$e_databin.html"> next </A>|</P>
<H1><A NAME="ToP">kdu_cache::add_to_databin</A></H1>
<DIR><DIR><H3><EM><U>Java:</U> Kdu_cache.Add_to_databin</EM></H3></DIR></DIR>
<P CLASS="function-text">virtual <B>bool</B> add_to_databin(
<B>int</B>&nbsp;databin_class,
<B>kdu_long</B>&nbsp;codestream_id,
<B>kdu_long</B>&nbsp;databin_id,
const&nbsp;<B>kdu_byte</B>&nbsp;data[],
<B>int</B>&nbsp;offset,
<B>int</B>&nbsp;num_bytes,
<B>bool</B>&nbsp;is_final,
<B>bool</B>&nbsp;add_as_most_recent=true,
<B>bool</B>&nbsp;mark_if_augmented=false)</P>
<DIR><DIR><P CLASS="function-text"><EM><U>Java:</U> public native boolean Add_to_databin(
int&nbsp;databin_class,
long&nbsp;codestream_id,
long&nbsp;databin_id,
byte[]&nbsp;data,
int&nbsp;offset,
int&nbsp;num_bytes,
boolean&nbsp;is_final,
boolean&nbsp;add_as_most_recent,
boolean&nbsp;mark_if_augmented)</EM></P></DIR></DIR>
<P><A HREF="kdu_cache.html">Go to class description.</A></P>

<P ALIGN="CENTER"><HR></P><H2><A NAME="SynopsiS">Synopsis</A></H2>
<DIV CLASS="indented-text">
<P>
Augments the cached representation of the indicated
data-bin. The data-bin is identified by a class code,
<A HREF="kdu_cache__add$o_databin.html#databin_class">databin_class</A>, a code-stream ID (normally 0, unless the cache is
used to manage multiple code-streams simultaneously)
and an in-class identifier, 
<A HREF="kdu_cache__add$o_databin.html#databin_id">databin_id</A>. Currently, the classes defined by this object are
<B>KDU_META_DATABIN</B>, 
<B>KDU_MAIN_HEADER_DATABIN</B>, 
<B>KDU_TILE_HEADER_DATABIN</B>, 
<B>KDU_PRECINCT_DATABIN</B> and 
<B>KDU_TILE_DATABIN</B>.
</P><UL><LI>
The 
<B>KDU_META_DATABIN</B> class is used with JP2-family file formats to communicate
metadata and file structure information. Amongst other
things, this metadata provides the framework within
which the content of code-stream specific data-bins
are to be interpreted. For this data-bin class, the
value of the 
<A HREF="kdu_cache__add$o_databin.html#codestream_id">codestream_id</A> is ignored. Raw code-streams have exactly one metadata-bin
(the one with 
<A HREF="kdu_cache__add$o_databin.html#databin_id">databin_id</A>=0) which must be empty &mdash; it must be signalled
as finalized after transferring 0 bytes of content
data.
</LI><LI>
For the 
<B>KDU_MAIN_HEADER_DATABIN</B> class, the in-class identifier must be equal to 0,
while the code-stream identifier indicates the code-stream
whose main header is being augmented.
</LI><LI>
For the 
<B>KDU_TILE_HEADER_DATABIN</B> class, the in-class identifier (
<A HREF="kdu_cache__add$o_databin.html#databin_id">databin_id</A>) holds the tile number, starting from 0 for the tile
in the upper left hand corner of the image.
</LI><LI>
For the 
<B>KDU_PRECINCT_DATABIN</B> class, the in-class identifier has the interpretation
described in connection with 
<A HREF="kdu$ource__set$nct_scope.html">kdu_compressed_source::set_precinct_scope</A>.
</LI><LI>
For the 
<B>KDU_TILE_DATABIN</B> class, the in-class identifier has the same interpretation
as for 
<B>KDU_TILE_HEADER_DATABIN</B>. Generally, an interactive communication involves
either the 
<B>KDU_TILE_HEADER_DATABIN</B> and 
<B>KDU_PRECINCT_DATABIN</B> classes, or the 
<B>KDU_TILE_DATABIN</B> class, but not both.
</LI></UL><P>
 New data may be added to the cache in any desired
order, which is why the absolute location (
<A HREF="kdu_cache__add$o_databin.html#offset">offset</A>) and length (
<A HREF="kdu_cache__add$o_databin.html#num_bytes">num_bytes</A>) of the new data are explicitly specified in the call.
If the new data range overlaps with data which already
exists in the cache, the present function may either
overwrite or leave the overlapping data bytes as they
were. Both interpretations are assumed to produce the
same result, since the nominal contents of any given
data-bin are not permitted to change over time.
</P><P>
 This function is completely thread-safe; multiple
threads may attempt to add data concurrently, since
access is serialized internally. However, this is not
recommended, since internal state information keeps
track of recently visited data-bins in a manner that
is intended to make access to this function efficient
if consecutive calls commonly reference nearby data-bins.
</P>
</DIV>

<P ALIGN="CENTER"><HR></P><H2><A NAME="ReturnS">Return Value</A></H2><DIV CLASS="indented-text">
<P>
False only if the function was unable to allocate sufficient
memory or if the 
<A HREF="kdu_cache__add$o_databin.html#databin_class">databin_class</A>, 
<B>stream_id</B> or 
<B>bin_id</B> appear to be invalid.
</P>
</DIV>
<H2><A NAME="ArgS">Arguments</A></H2><DIV CLASS="indented-text">
<H4><A NAME="databin_class">databin_class</A> [<B>int</B>]</H4><DIV CLASS="indented-text">
</DIV>
<H4><A NAME="codestream_id">codestream_id</A> [<B>kdu_long</B>]</H4><DIV CLASS="indented-text">
</DIV>
<H4><A NAME="databin_id">databin_id</A> [<B>kdu_long</B>]</H4><DIV CLASS="indented-text">
</DIV>
<H4><A NAME="data">data[]</A> [const&nbsp;<B>kdu_byte</B>]</H4><DIV CLASS="indented-text">
</DIV>
<H4><A NAME="offset">offset</A> [<B>int</B>]</H4><DIV CLASS="indented-text">
</DIV>
<H4><A NAME="num_bytes">num_bytes</A> [<B>int</B>]</H4><DIV CLASS="indented-text">
</DIV>
<H4><A NAME="is_final">is_final</A> [<B>bool</B>]</H4><DIV CLASS="indented-text">
<P>
If true, the cache is being informed that the supplied
bytes represent the terminal portion of the data-bin.
If there are no holes, the cache representation is
complete. If there are holes, the cache representation
of the data-bin will be complete once these holes have
been filled in. At that time, the 
<A HREF="kdu_cache__get$in_length.html">get_databin_length</A> function will set an 
<B>is_complete</B> argument to true.
</P>
</DIV>
<H4><A NAME="add_as_most_recent">add_as_most_recent</A> [<B>bool</B>]</H4><DIV CLASS="indented-text">
<P>
Ignored by the current implementation of this object,
since the concept of "most-recently used" and "least-recently
used" not longer exists in the form that it did prior
to KDU-7.6. In practice, the implementation keeps track
of several paths through the cache hierarchy, corresponding
to added data-bins, open data-bins, and so forth, and
these paths retain access locks. Nothing will be automatically
removed from the cache until those locks are removed,
and the order in which they are removed depends on
the order in which the locks disappeared, not the order
in which they appeared.
</P><P>
 For backward compatibility at least, we do retain
this argument; you may pass either true or false.
</P>
</DIV>
<H4><A NAME="mark_if_augmented">mark_if_augmented</A> [<B>bool</B>]</H4><DIV CLASS="indented-text">
<P>
If true, and the present call augments the cached contents
of the indicated data-bin, the data-bin is assigned
a special flag that allows the application, or higher
level API's such as 
<A HREF="kdu_client.html">kdu_client</A>, to determine whether a remote JPIP server needs to
have its cache model updated. The marked state can
be discovered and manipulated by calling 
<A HREF="kdu_cache__mark_databin.html">mark_databin</A>. In particular, if this argument is true and the data-bin
is augmented by the call, the 
<A HREF="globals.html#KDU_CACHE_BIN_MARKED">KDU_CACHE_BIN_MARKED</A> flag is set; moreover if the data-bin was previously
unmarked and was non-empty, the 
<A HREF="globals.html#KDU_CACHE_BIN_AUGMENTED">KDU_CACHE_BIN_AUGMENTED</A> flag is also set. These flags are explained in detail
with the 
<A HREF="kdu_cache__mark_databin.html">mark_databin</A> function.
</P>
</DIV>
</DIV>

<P ALIGN="CENTER"><HR></P><P ALIGN="RIGHT">|<A HREF="#ToP"> top </A>||<A HREF="#SynopsiS"> synopsis </A>||<A HREF="#ReturnS"> return value </A>||<A HREF="#ArgS"> arguments </A>||<A HREF="kdu_cache__close.html"> prev </A>||<A HREF="kdu_cache__del$e_databin.html"> next </A>|</P>
</BODY>
</HTML>
