<HTML>
<HEAD>
<TITLE> Kakadu Hyper-Doc (jp2_input_box::load_in_memory) </TITLE>
<STYLE TYPE="text/css">
<!--
.indented-text { padding-left: 20pt; }
.function-text { padding-left: 80pt;
                 text-indent: -60pt; }
-->
</STYLE>
</HEAD>
<BODY TEXT="#000000" LINK="#0000ff" BGCOLOR="#B4DCB4">
<P ALIGN="RIGHT">|<A HREF="#SynopsiS"> synopsis </A>||<A HREF="#ReturnS"> return value </A>||<A HREF="#ArgS"> arguments </A>||<A HREF="jp2$t_box__get_pos.html"> prev </A>||<A HREF="jp2$t_box__acc$ss_memory.html"> next </A>|</P>
<H1><A NAME="ToP">jp2_input_box::load_in_memory</A></H1>
<DIR><DIR><H3><EM><U>Java:</U> Jp2_input_box.Load_in_memory</EM></H3></DIR></DIR>
<P CLASS="function-text">virtual <B>bool</B> load_in_memory(
<B>int</B>&nbsp;max_bytes,
<B>void</B>&nbsp;*&nbsp;external_buffer=NULL,
<B>int</B>&nbsp;external_buffer_size=0)</P>
<DIR><DIR><P CLASS="function-text"><EM><U>Java:</U> public native boolean Load_in_memory(
int&nbsp;max_bytes)</EM></P></DIR></DIR>
<P><A HREF="jp2$t_box.html">Go to class description.</A></P>

<P ALIGN="CENTER"><HR></P><H2><A NAME="SynopsiS">Synopsis</A></H2>
<DIV CLASS="indented-text">
<P>
This function attempts to load the entire contents
of the box into an block of memory. If successful,
the 
<A HREF="jp2$t_box__get$abilities.html">get_capabilities</A> function will report the following capability flags:
<A HREF="globals.html#KDU_SOURCE_CAP_SEQUENTIAL">KDU_SOURCE_CAP_SEQUENTIAL</A>, 
<A HREF="globals.html#KDU_SOURCE_CAP_SEEKABLE">KDU_SOURCE_CAP_SEEKABLE</A> and 
<A HREF="globals.html#KDU_SOURCE_CAP_IN_MEMORY">KDU_SOURCE_CAP_IN_MEMORY</A>. Moreover, the 
<A HREF="jp2$t_box__acc$ss_memory.html">access_memory</A> function can then be used to directly access the memory
block, as an alternative to using the 
<A HREF="jp2$t_box__seek.html">seek</A> and 
<A HREF="jp2$t_box__read__1.html">read</A> functions.
</P><P>
 Normally, the block of memory is allocated in memory,
but in some applications unnecessary allocations can
be avoided by supplying an external buffer that is
likely to be large enough. In this case, the 
<A HREF="jp2$t_box__loa$in_memory.html#external_buffer">external_buffer</A> would be non-NULL and its size (in bytes) is supplied
by 
<A HREF="jp2$t_box__loa$in_memory.html#external_buffer_size">external_buffer_size</A>. If this turns out to be insufficient, an internal
buffer will be allocated anyway, but the caller can
discover this by comparing the contents length after
a successful call with the 
<A HREF="jp2$t_box__loa$in_memory.html#external_buffer_size">external_buffer_size</A> that was passed in &mdash; the buffer need only be
large enough to hold the box contents, not its header.
</P><P>
 The function may fail if, for example, the ultimate
source of information is a 
<A HREF="kdu$ource.html">kdu_compressed_source</A> object which does not offer 
<A HREF="globals.html#KDU_SOURCE_CAP_SEQUENTIAL">KDU_SOURCE_CAP_SEQUENTIAL</A>. While the conditions under which the source cannot
be loaded directly into a block of memory may be rather
technical, you need not worry about the details. If
the function succeeds, it will return true; otherwise
it returns false and you must access the box contents
via the 
<A HREF="jp2$t_box__read__1.html">read</A> function.
</P><P>
 If an internal memory block is allocated, it spans
the entire extent of the box contents, but does not
include its header; any internal memory block is deleted
when the box is closed (or destroyed), but this is
not true of an 
<A HREF="jp2$t_box__loa$in_memory.html#external_buffer">external_buffer</A>.
</P><P>
 You may, if you like, call this function after the
box has already been read, in whole or in part, so
long as it has not yet been closed. In this case, however,
the function is not likely to return true unless the
source is seekable.
</P>
</DIV>

<P ALIGN="CENTER"><HR></P><H2><A NAME="ReturnS">Return Value</A></H2><DIV CLASS="indented-text">
<P>
True if and only if a memory block was allocated (or
supplied) and loaded with the box contents (either
by this function, or else by a previous call to this
function in the present box or a super-box). Whether
or not the function returns true, you can always seek
within the box and read its contents using the 
<A HREF="jp2$t_box__seek.html">seek</A> and 
<A HREF="jp2$t_box__read__1.html">read</A> functions. However, only in the case that the function
returns true can you directly access the loaded box
contents via the 
<A HREF="jp2$t_box__acc$ss_memory.html">access_memory</A> function.
</P><P>
 In the special case where the ultimate data source
terminates prematurely, prior to the nominal end of
the box, the present function may still allocate a
memory block and return true (assuming that this is
what it would have done if the data source did not
terminate prematurely). However, the internal length
of the box will be adjusted to reflect the amount of
data which is actually available. If your application
needs to know whether or not premature termination
has occurred, you can call the 
<A HREF="jp2$t_box__get$box_bytes.html">get_box_bytes</A> function before and after the present function, comparing
the two results.
</P>
</DIV>
<H2><A NAME="ArgS">Arguments</A></H2><DIV CLASS="indented-text">
<H4><A NAME="max_bytes">max_bytes</A> [<B>int</B>]</H4><DIV CLASS="indented-text">
<P>
Specifies a limit on the size of the memory block that
you are prepared to have allocated internally, in order
for this function to succeed. If the length of the
box contents exceeds this value and no suitable 
<A HREF="jp2$t_box__loa$in_memory.html#external_buffer">external_buffer</A> is supplied, the function returns false without allocating
any memory.
</P>
</DIV>
<H4><A NAME="external_buffer">external_buffer</A> [<B>void</B>&nbsp;*]</H4><DIV CLASS="indented-text">
<P>
If non-NULL, the function attempts to use this buffer
to store the box contents instead of allocating its
own.
</P>
</DIV>
<H4><A NAME="external_buffer_size">external_buffer_size</A> [<B>int</B>]</H4><DIV CLASS="indented-text">
<P>
Number of bytes in the 
<A HREF="jp2$t_box__loa$in_memory.html#external_buffer">external_buffer</A> (ignored if NULL). If this value is smaller than the
number of bytes in the box contents, the 
<A HREF="jp2$t_box__loa$in_memory.html#external_buffer">external_buffer</A> will not be used.
</P>
</DIV>
</DIV>

<P ALIGN="CENTER"><HR></P><P ALIGN="RIGHT">|<A HREF="#ToP"> top </A>||<A HREF="#SynopsiS"> synopsis </A>||<A HREF="#ReturnS"> return value </A>||<A HREF="#ArgS"> arguments </A>||<A HREF="jp2$t_box__get_pos.html"> prev </A>||<A HREF="jp2$t_box__acc$ss_memory.html"> next </A>|</P>
</BODY>
</HTML>
